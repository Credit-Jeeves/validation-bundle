@extends=../default/checks.ini

[set parameters]
file2="app/config/parameters_dev.yml"

[short_open_tag]
option=short_open_tag
expected=
@class=Hat\Environment\Tester\PhpIni
@description="short_open_tag should be disabled in php.ini"

[xdebug nesting level]
option=xdebug.max_nesting_level
regex=/1000/
@class=Hat\Environment\Tester\PhpIni
@required=false
@description="XDebug nesting level should be %%REGEX%%"

[phpunit version]
command=phpunit --version
version=3.7.15
@class=Hat\Environment\Tester\CommandVersion
@description="PHPUnit version must be at least %%VERSION%%"

[copy web directory]
file=web/_test.php
@class=Hat\Environment\Tester\FileExists
@on.fail=../builder/web_files.ini

[cache clear dev]
command="php bin/console.php cache:clear --env=dev --no-warmup"
@class=Hat\Environment\Builder\ExecuteCommand

[cache clear test]
command="php bin/console.php cache:clear --env=test --no-warmup"
@class=Hat\Environment\Builder\ExecuteCommand

[install test routs for cj]
command="php app/console fos:js-routing:dump --app=cj --env=test --target=web/bundles/fosjsrouting/js/cj_test.js"
@class=Hat\Environment\Builder\ExecuteCommand

[install test routs for rj]
command="php app/console fos:js-routing:dump --app=rj --env=test --target=web/bundles/fosjsrouting/js/rj_test.js"
@class=Hat\Environment\Builder\ExecuteCommand

[install assets for cj]
command="php bin/console --app=cj assets:install --symlink --relative --env=dev"

[install assets for rj]
command="php bin/console --app=rj assets:install --symlink --relative --env=dev"

[install crontab]
options="data/crontabs/dev"

[backup test DB]
command="php bin/console.php --app=rj --env=test database:backup"
@class=Hat\Environment\Builder\ExecuteCommand
