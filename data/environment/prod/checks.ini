[composer install]
@class=Hat\Environment\Tester\Pass
@build.on.pass=builder/install.ini

[php version exclude]
command=php -v
version=5.3.16
@class=Hat\Environment\Tester\CommandVersionExclude
@description="PHP version must not be %%VERSION%% as Symfony 2 will not work properly with it"

[mysql installed]
command=mysql
@class=Hat\Environment\Tester\CommandExists
@description="MySQL must be installed"

[mysql version]
command=mysql --version
version=5.5
@class=Hat\Environment\Tester\CommandVersion
@description="MySQL version must be at least %%VERSION%%"

[mysql is working]
process=mysqld
@class=Hat\Environment\Tester\Process
@description="MySQL is working"

[ngnix is working]
process=www-data
@class=Hat\Environment\Tester\Process
@description="NGNIX is working as a process '%%PROCESS%%'"

[ngnix is working on port]
port=80
ip=127.0.0.1
@class=Hat\Environment\Tester\Socket
@description="NGNIX is working on %%IP%%:%%PORT%%"

[ngnix answer on request]
port=80
ip=127.0.0.1
request="GET / HTTP/1.1\r\nHost: localhost\r\nConnection: Close\r\n\r\n"
response=nginx
@class=Hat\Environment\Tester\Socket
@description="NGNIX answer on request to %%IP%%:%%PORT%%"

[pdo installed]
class=PDO
@class=Hat\Environment\Tester\PhpClassExists
@description="PDO must be installed"

[current dir is writable]
path=.
@class=Hat\Environment\Tester\IsWritable
@description="Current dir must be writable"

[short_open_tag]
option=short_open_tag
expected=
@class=Hat\Environment\Tester\PhpIni
@description="short_open_tag should be disabled in php.ini"

[date.timezone setting must be set]
option=date.timezone
regex=/.+/i
@class=Hat\Environment\Tester\PhpIni

[setfacl installed]
command=setfacl
@class=Hat\Environment\Tester\CommandExists
@description="setfacl must be installed"

[getfacl installed]
command=getfacl
@class=Hat\Environment\Tester\CommandExists
@description="setfacl must be installed"


; BUILDS

[check cache permissions]
command=getfacl app/cache
regex="/default:user:www-data:rwx/"
@class=Hat\Environment\Tester\CommandOutput
@builder=builder/permissions.ini

[check logs permissions]
command=getfacl app/logs
regex="/default:user:www-data:rwx/"
@class=Hat\Environment\Tester\CommandOutput
@builder=builder/permissions.ini

[set parameters]
file="app/config/parameters.yml"
file2="app/config/parameters_prod.yml"
@description="Config %%FILE%% must be edentical to %%FILE2%%"
@class=Hat\Environment\Tester\FilesIdentical
@builder=builder/parameters.ini



