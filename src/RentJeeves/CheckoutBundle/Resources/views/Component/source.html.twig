{% form_theme paymentAccountType 'RjCoreBundle::form.html.twig' %}

<div class="form-row clearfix">
    <div class="fields-box">
        <small><b>*</b>{{ 'required' | trans  }}</small>
    </div>
</div>

<form {{ form_enctype(paymentAccountType) }} novalidate method="post">
    {{ form_widget(paymentAccountType) }}
    {{ JSFV(paymentAccountType) }}
</form>
<p class="note" data-bind="visible: 'card' == paymentSource.type()">
    <strong>{{ 'checkout.fee.note' | trans({'%FEE%': payment_card_fee}) }}</strong>
    <i title="{{ 'checkout.fee.note.help' | trans }}" class="help after-checkbox pie-el tooltip-link">?</i>
</p>

<script type="text/javascript">
    window.addressesViewModels = [];
{% for address in addresses %}
    var address = new Address(null);
    ko.mapping.fromJS({{ address | serialize('json') | raw }}, {}, address);
    window.addressesViewModels.push(address);
{% endfor %}

    window.paymentAccounts = [];
{% for paymentAccount in paymentAccounts %}
    window.paymentAccounts.push({{ paymentAccount | serialize('json') | raw }});
{% endfor %}
</script>
