
{% form_theme form 'RjCoreBundle::radio.html.twig' %}

<div id="contract-actions">
    {%  include 'RjComponentBundle:ContractsList:_remove_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_end_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_revoke_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_edit_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_approve_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_merge_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_review_contract.landlord_actions.html.twig' %}

    {%  include 'RjComponentBundle:ContractsList:_add_property.landlord_actions.html.twig' %}
</div>

<div id="contracts-block">
    <div class="landrord-box">
        <div class="title-box clearfix">

            <input type="hidden" id="searchColumn" value="{{ searchColumn }}">
            <input type="hidden" id="searchText" value="{{ searchText }}">

            <h2 data-bind="text: 'All (' + $root.total() + ')'"></h2>
            <div class="fiter-box">
                <label>{{'filter.by'|trans}}</label>
                <select id="searchFilter" class="select custom-select blue-arrow selectBox" style="display: none;">
                    <option selected="selected" value="status">{{'filter.status'|trans}}</option>
                    <option value="email">{{ 'email'|trans }}</option>
                    <option value="phone">{{ 'phone'|trans }}</option>
                    <option value="street">{{ 'street'|trans }}</option>
                    <option value="rent">{{ 'amount'|trans }}</option>
                    <option value="tenant">{{ 'tenant'|trans }}</option>
                </select>
                <div id="searchInput" style="display:none;" class="finder-box">
                    <input
                        type="text"
                        id="searsh-field"
                        name="searsh-field"
                        data-bind="value: searchText"
                        value="">
                    <a
                        href="#"
                        id="delete"
                        class="pie-el"
                        data-bind="click: clearSearch, style: { visibility: isSearch() ? 'visible': 'hidden' }">x</a>
                    <button type="submit" id="search-submit" class="pie-el" data-bind="click: search">
                        {{ 'search'|trans }}
                    </button>
                </div>
                <div id="searchSelect" class="finder-box" >
                    <select id="searchPaymentsStatus" class="select custom-select blue-arrow selectBox">
                        <option value=''>- {{'select.status.all'|trans}} -</option>
                        <option value='pending'>{{ 'contract.status.pending' | trans() }}</option>
                        <option value='invite'>{{ 'contract.status.invite' | trans() }}</option>
                        <option value='approved'>{{ 'contract.status.approved' | trans() }}</option>
                        <option value='current'>{{ 'contract.status.select.current' | trans() }}</option>
                        <option value='finished'>{{ 'contract.status.finished' | trans() }}</option>
                        <option value='waiting'>{{ 'contract.statuses.waiting' | trans() }}</option>
                        <!--option value='deleted'>{{ 'contract.status.deleted' | trans() }}</option-->
                    </select>
                    <button type="submit" id="search-submit-payments-status" data-bind="click: search" class="pie-el">{{ 'search' }}</button>
                </div>
                {% if canInvite %}
                    <button class="button small" data-bind="click: $root.addTenant">
                        <span>{{ 'add.tenant'|trans }}</span>
                    </button>
                {% else %}
                    <button class="button small grey" title="{{ 'landlord.add_tenant.hover'|trans }}">
                        <span>{{ 'add.tenant'|trans }}</span>
                    </button>
                {% endif %}
            </div>
        </div>
        <!-- ko if: $root.agentContracts().length > 0  -->
        <div id="foundMoreContainer" class="information-box pie-el">
            <span>{{ 'landlord.tenant.found_more'|trans }}</span>
            <!-- ko foreach: { data: agentContracts() } -->
                <a href="#" data-bind="
                        attr: {title: name},
                        text: name,
                        click: $parent.changeGroup,
                        clickBubble: false">
                </a><span data-bind="visible: $index()+1 < $root.agentContracts().length && $root.agentContracts().length > 1">, </span><!-- /ko -->
        </div>
        <!-- /ko -->
        <div class="content-box">
            <div class="properties-table-block table-wrap">
        <div class="table-margin">
          <!-- ko if: countContracts() -->
          <table class="properties-table zebra-grid">
            <thead>
              <tr class="properties-th">
                <th class="pie-el column-status">
                    <span class="sort" id="status" data-bind="click: sortFunction">{{'filter.status'|trans}}<i> </i></span>
                </th>
                <th class="pie-el column-name">
                    <span class="sort" id="first_name" data-bind="click: sortFunction">{{'tenant'|trans}}<i> </i></span>
                </th>
                <th class="pie-el column-email">
                    <span class="sort" id="email" data-bind="click: sortFunction">{{'email'|trans}}<i> </i></span>
                </th>
                <th class="pie-el column-phone">
                    <span>{{'phone'|trans}}</span>
                </th>
                <th class="pie-el column-address">
                    <span class="sort" id="street" data-bind="click: sortFunction">{{'property'|trans}}<i> </i></span>
                </th>
                <th class="pie-el column-amount">
                    <span class="sort" id="rent" data-bind="click: sortFunction">{{'amount'|trans}}<i> </i></span>
                </th>
                <th class="pie-el column-last">
                    <span class="pie-el">{{'contract.payment.last'|trans}}<i> </i></span>
                </th>
                {% if isIntegrated %}
                <th class="pie-el column-paid">
                    <span class="sort" id="balance" data-bind="click: sortFunction">
                        {{'common.balance'|trans}}<i> </i>
                    </span>
                </th>
                {% endif %}
                <th class="pie-el column-action">&nbsp;</th>
              </tr>
            </thead>
            <tbody>
            <!-- ko foreach: { data: aContracts() } -->
            <tr>
                <td data-bind="attr: {'class': 'actions-status '+style}">
                    <!-- ko if: status_label.choice == true -->
                        <div data-bind="text: Translator.transChoice(status_label.label, status_label.count, status_label.params) "></div>
                    <!-- /ko -->
                    <!-- ko ifnot: status_label.choice == true -->
                        <div data-bind="text: Translator.trans(status_label.label, status_label.params)"></div>
                    <!-- /ko -->
                </td>
                <td class="email-box ellipsis-box">
                  <div data-bind="if: credit_track_enabled">
                      <div class="tenantName" data-bind="text: tenant"></div>
                      <div class="clarification">
                        <i class="csm-icon" data-bind="visible: credit_track_enabled"></i>
                        <i class="alert" title="{{ 'landlord.property.manager_disabled_payment'|trans }}"
                           data-bind="visible: !isPaymentEditAllowed"></i>
                      </div>
                  </div>
                  <div data-bind="if: !credit_track_enabled">
                    <div class="tenantName" data-bind="text: tenant"></div>
                      <div class="clarification">
                        <i class="alert one" title="{{ 'landlord.property.manager_disabled_payment'|trans }}"
                           data-bind="visible: !isPaymentEditAllowed"></i>
                      </div>
                  </div>
                </td>
                <td class="email-box ellipsis-box" data-bind="text: email"></td>
                <td data-bind="text: phone"></td>
                <td class="property-box ellipsis-box"
                data-bind="text: address, event: { dblclick: $root.filterAddress }"></td>
                <!-- ko if: amount != '' -->
                <td data-bind="text: '$'+amount"></td>
                <!-- /ko -->
                <!-- ko if: amount == '' -->
                <td data-bind="text: '-' + amount"></td>
                <!-- /ko -->
                <td align="center"   data-bind="text: last_payment"></td>
                {% if isIntegrated  %}
                    <td align="center"  data-bind="text: balance"></td>
                {% endif %}
                <td class="type-box">
                    <!-- ko if: 'CURRENT' == status || 'WAITING' == status || 'INVITE' == status || 'APPROVED' == status  || 'CONTRACT ENDED' == status || 'late' == status_name -->
                    <a title="{{ 'edit'|trans }}" class="type-ico pie-el edit" href="#"
                     data-bind="click: $root.editContract, attr:{'id': 'edit-' + id}">&nbsp;</a>
                    <!-- /ko -->
                    <!-- ko if: 'PENDING' == status -->
                    {% if canInvite %}
                    <a title="{{ 'approve'|trans }} " class="type-ico pie-el approve" href="#"
                    data-bind="click: $root.approveContract, attr:{'id': 'edit-' + id}">&nbsp;</a>
                    {% else %}
                    <a title="{{ 'approve'|trans }} " class="type-ico pie-el approve grey" href="#"
                    >&nbsp;</a>
                    {% endif %}
                    <!-- /ko -->
                    <!-- ko ifnot: 'PENDING' == status || 'WAITING' == status || 'CURRENT' == status || 'INVITE' == status || 'APPROVED' == status || 'CONTRACT ENDED' == status || 'late' == status_name -->
                    <a title="{{'review'|trans}}" class="type-ico pie-el review" href="#" data-bind="click: $root.reviewContract, attr:{'id': 'edit-' + id}">&nbsp;</a>
                    <!-- /ko -->
                </td>
            </tr>
            <!-- /ko -->
            </tbody>
          </table>
        <!-- /ko -->
        <!-- ko if: processLoading()  -->
            <img src="/bundles/core/images/img_loading.gif" id="processLoading" class="processLoading" >
        <!-- /ko -->
        <!-- ko if: notHaveResult()  -->
            <h3 class="notHaveData">{{ 'donthavedata'|trans }}</h3>
        <!-- /ko -->
        </div>
      </div>
    </div>
  </div>
  <div class="landrord-box without-top clearfix">
    <div class="legeng-box">
      <ul class="legeng">
        <li class="tr">
          <div class="th cell">
            Legend
          </div>
          <div class="th cell"></div>
        </li>
        <li class="tr">
          <div class="cell">
            <ul class="vert">
              <li>
                <span class="clarification alert"><i> </i>{{'alert'|trans}}</span>
              </li>
              <li>
                <span class="clarification pending"><i> </i>Pending</span>
              </li>
            </ul>
          </div>
          <div class="cell">
            <ul class="hor">
              <li>
                <span class="clarification e-check"><i> </i>{{'E-Check'|trans}}</span>
                <span class="clarification credit-card"><i> </i>{{'credit.card'|trans}}</span>
                <span class="clarification recurring"><i> </i>{{ 'recurring'|trans }}</span>
                <span class="clarification csm-icon"><i> </i>
                    {{'credit.service.member'|trans }}
                </span>
              </li>
              <li>
                <span class="clarification review"><i> </i>{{'review'|trans}}</span>
                <span class="clarification edit"><i> </i>{{'Edit'|trans}}</span>
                <span class="clarification approve"><i> </i>{{'approve'|trans}}</span>
                <span class="clarification alert"><i> </i>{{'alert'|trans}}</span>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <nav class="pagination-box">
    <!-- ko if: pages().length -->
    <ul>
        <!-- ko foreach: pages() -->
                <!-- ko if: $data == $root.current() -->
                <li><span data-bind="click: $root.goToPage, text: $data"></span></li>
                <!-- /ko -->
                <!-- ko ifnot: $data == $root.current() -->
                 <li><a href='#' data-bind="click: $root.goToPage, text: $data"></a></li>
                <!-- /ko -->
        <!-- /ko -->
    </ul>
    <!-- /ko -->
    </nav>

  </div>
</div>
